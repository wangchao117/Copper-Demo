<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="OCR recognition front end.">
  <meta name="keywords" content="HTML, CSS, JS, JavaScript, jQuery,image cropping, web development">
  <title>搜索题库</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/font-awesome.min.css">
  <link rel="stylesheet" href="dist/cropper.min.css">
  <link rel="stylesheet" href="assets/css/tooltip.min.css">
  <link rel="stylesheet" href="css/main.css">
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="loading" class="hid">搜索中...</div>
<div class="error-list" id="content_list">
    
</div>
<div class="hide" id="clone_list">
    <dl>
        <dd class="cont clearfix">
            <div class="lin-heig intr clearfix">
                <span class="nandu">题目来源：<span class="wh laiyuan source"></span></span>
            </div>
            <div class="lin-heig clearfix"><div class="mathContent"></div></div>
            <div class="lin-heig clearfix lin-heig">
                <span  class="correct-answer fl">正确答案：</span>
                <div class="answer fl">
                    <p class="answer-detail fl mathAnswers"></p>
                </div>
            </div>
        </dd>
    </dl>
</div>
<script src="assets/js/jquery.min.js"></script>
<script src="js/mathUtil.js"></script>
<script type="text/x-mathjax-config">
function init(){
	MathJax.Hub.Config({
		jax: ["input/TeX","output/HTML-CSS"],
		"HTML-CSS": {
			webFont:"TeX",
			imageFont: null
		},
		tex2jax:{
			inlineMath:[['$','$']],
			processEscapes: false
		},
		asciimath2jax:{
			delimiters:[['`','`']]
		},
		showMathMenu:false
	});
}
init();
$(function(){
	var serialize = function(obj) {
            var str = [];
            for(var p in obj)
               if (obj.hasOwnProperty(p)) {
                   str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
               }
            return str.join("&");
    }

    function showObject(obj) {
         var result = "";
         for (var p in obj) {
            if( obj.hasOwnProperty(p) ) {
                result += p + " , " + obj[p] + "\n";
            } 
         }              
         return result;
    }

    var searchText = localStorage.getItem("searchText");
    console.log('text: ' + searchText);
    searchText = $.trim(searchText);
    //alert('search for ' + searchText);

    var jobj = {};
    jobj.searchBy = searchText;

    //construct link here
    var restUrl = '/RecoServices/searchfh?' + serialize(jobj);
    console.log('url: ' + restUrl);
    $("#loading").show();
	$.get(restUrl,{q:'OCR'},function(res){
	    $("#loading").hide();
        console.log('type of res ' + typeof(res));
        console.log('search result: ' + res);
		//var data = eval('(' + res + ')');
        var temp = JSON.parse(res);
        var data = temp.qlist;
        console.log(res.content);
		for(var i = 0; i < data.length; i++){
			console.log('data: ' + data[i]);
			//mathUtil.parseTexMathQuestion(data[i].content);
		}
		setTimeout(function(){
			MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
		}, 50);
		for(var i in data){
			var obj = $("#clone_list dl").clone();
			obj.find('.difficulty').html('unknown');
			obj.find('.allMetaKnowpoint').html('');
			obj.find('.source').html(data[i].id);
			obj.find('.mathContent').html(data[i].content);
			obj.find('.mathAnswers').html('NA');
			$("#content_list").append(obj);
		}
		$(".mathContent img").each(function(index, element) {
			//var src = 'http://yoomath.com' + $(this).attr('src');
			$(this).attr('src',src);
		});	
	},'text');
});
</script>
<script type="text/javascript" src="dist/mathjax/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>
